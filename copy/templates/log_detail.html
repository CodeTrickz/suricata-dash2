<!doctype html>
<html lang="nl">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{{ filename }} – Suricata logs</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
      :root {
        --bg: #030816;
        --panel: #132440;
        --panel-light: #20375c;
        --text: #fff8fb;
        --muted: #dce4ff;
        --accent: #8fe8ff;
      }
      body { background-color: var(--bg); color: var(--text); }
      h1, h4 { color: #ffe8c2; }
      .text-secondary { color: var(--muted) !important; }
      .card {
        background: linear-gradient(135deg, var(--panel), var(--panel-light));
        border: 1px solid rgba(255,255,255,0.08);
        border-radius: 0.9rem;
        color: var(--text);
      }
      .card.bg-dark {
        background: linear-gradient(135deg, #1a2e4f, #2b4570) !important;
      }
      pre {
        background-color: #08172d;
        color: #f2f6ff;
        padding: 1rem;
        border-radius: .75rem;
        max-height: 75vh;
        overflow-y: scroll;
        font-size: 0.92rem;
      }
      a, a:hover { color: var(--accent); }
    </style>
  </head>
  <body>
    <div class="container py-4">
      <div class="d-flex justify-content-between align-items-center mb-3 flex-wrap gap-3">
        <div>
          <h1 class="h4 mb-1">{{ filename.split('/')[-1] if '/' in filename else filename }}</h1>
          {% if dirname %}
          <p class="text-secondary mb-0">Directory: {{ dirname }}</p>
          {% endif %}
          <p class="text-secondary mb-0">Pad: {{ log_dir }}/{{ filename }}</p>
        </div>
        <div>
          <a class="btn btn-outline-light me-2" href="/">← Terug naar dashboard</a>
          <a class="btn btn-outline-secondary" href="/logs/{{ filename }}/download">Download</a>
        </div>
      </div>

      <div class="alert alert-secondary text-dark bg-opacity-75 border-0 mb-4" role="alert">
        Deze pagina toont de meest recente regels uit dit logbestand. Zoek naar woorden zoals <strong>alert</strong>, <strong>drop</strong> of IP-adressen om snel te begrijpen wat er gebeurde.
      </div>

      <div class="row g-3 mb-4">
        <div class="col-md-4">
          <div class="card bg-dark p-3">
            <p class="text-secondary mb-1">Grootte</p>
            <h5>{{ (size / (1024*1024)) | round(2) }} MB</h5>
          </div>
        </div>
        <div class="col-md-4">
          <div class="card bg-dark p-3">
            <p class="text-secondary mb-1">Laatste wijziging</p>
            <h5>{{ updated.strftime("%Y-%m-%d %H:%M:%S") }}</h5>
          </div>
        </div>
        <div class="col-md-4">
          <div class="card bg-dark p-3">
            <p class="text-secondary mb-1">Previewregels</p>
            <h5>{{ preview|length }}</h5>
          </div>
        </div>
      </div>

      <div class="card bg-dark p-3">
        <h4 class="mb-2">Laatste {{ preview|length }} regels</h4>
        <p class="text-secondary small mb-3">Tip voor niet-experts: iedere regel start met een datum. Alles wat daarna komt beschrijft wat Suricata zag (bijv. bron → doel, protocol, beschrijving).</p>
        <pre>
{% for line in preview %}
{{ line }}
{% endfor %}
        </pre>
      </div>
    </div>
  </body>
</html>

